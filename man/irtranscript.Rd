% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/irtranscript.R
\name{irtranscript}
\alias{irtranscript}
\title{Transcript-level intron retention scoring by permutation}
\usage{
irtranscript(df, score, save_dir, nperms = 1e+05)
}
\arguments{
\item{df}{A data.frame of introns, must include:
\itemize{
\item \code{gene}: gene identifier
\item \code{Nested}: intron classification ("Parent","Nested","Orphan")
\item \code{Intron_cluster}: cluster ID for parent–nested groups
\item at least one column of numeric scores (e.g., Z-scores of log2FC(IRratio) or raw IRratio)
}}

\item{score}{Character vector of column names in \code{df} to analyze (e.g., \code{"SNAR_IRratio_z"}).
Each score column is processed in turn.}

\item{save_dir}{User defined directory for saving the final output; one TSV per score will be saved.}

\item{nperms}{Number of permutations to build the null distribution (default = 100,000).}
}
\value{
A data.frame with one row per gene, including:
\itemize{
\item \code{gene}: gene ID
\item \code{obs.IRratio}: observed transcript-level median score
\item \code{exp.IRratio}: mean expected score from permutations
\item \code{pval_low}: empirical p-value for observed ≤ random
\item \code{pval_high}: empirical p-value for observed ≥ random
\item \code{sd}: standard deviation of permutation distribution
\item \code{z_score}: standardized Z of observed vs expected
\item \code{num_intron}: number of introns considered for the gene
\item \code{num_intron_without_nested}: number of orphans + clusters used
}
}
\description{
For each gene, this function aggregates intron-level scores (e.g., Z-scores of log2FC(IRratio) or raw IRratio)
into a transcript-level "distribution" score. It accounts for nested introns by taking
the median of each parent–nested cluster rather than treating every intron independently.
The observed median score is compared to a null distribution of medians obtained from
random intron sampling, allowing estimation of empirical p-values and Z-scores.
}
\details{
The algorithm:
\enumerate{
\item For each gene, classify introns as orphan or part of clusters.
\item Compute the median score per cluster and per orphan intron.
\item Combine these into an observed transcript-level score.
\item Compare to a null distribution of random medians sampled from all introns.
\item Report p-values, expected score, and Z-score for each gene.
}
}
\examples{
\dontrun{
# assuming df already has intron-level z-scores
res <- irtranscript(df, score = "SNAR_IRratio_z")
head(res)
}
}
